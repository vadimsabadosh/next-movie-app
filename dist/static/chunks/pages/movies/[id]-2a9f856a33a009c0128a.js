(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[92],{570:function(e,t,i){"use strict";i.d(t,{a:function(){return h}});var r=i(655),s=(i(4909),i(7294)),n=i(2152),o=i(1498),u=i(5942),a=i(4901),l=function(e){function t(t){var i=t.options,r=t.context,s=t.onNewData,n=e.call(this,i,r)||this;return n.runLazy=!1,n.previous=Object.create(null),n.runLazyQuery=function(e){n.cleanup(),n.runLazy=!0,n.lazyOptions=e,n.onNewData()},n.obsRefetch=function(e){var t;return null===(t=n.currentObservable)||void 0===t?void 0:t.refetch(e)},n.obsFetchMore=function(e){var t;return null===(t=n.currentObservable)||void 0===t?void 0:t.fetchMore(e)},n.obsUpdateQuery=function(e){var t;return null===(t=n.currentObservable)||void 0===t?void 0:t.updateQuery(e)},n.obsStartPolling=function(e){var t;null===(t=n.currentObservable)||void 0===t||t.startPolling(e)},n.obsStopPolling=function(){var e;null===(e=n.currentObservable)||void 0===e||e.stopPolling()},n.obsSubscribeToMore=function(e){var t;return null===(t=n.currentObservable)||void 0===t?void 0:t.subscribeToMore(e)},n.onNewData=s,n}return(0,r.ZT)(t,e),t.prototype.execute=function(){this.refreshClient();var e=this.getOptions(),t=e.skip,i=e.query;return(t||i!==this.previous.query)&&(this.removeQuerySubscription(),this.removeObservable(!t),this.previous.query=i),this.updateObservableQuery(),this.getExecuteSsrResult()||this.getExecuteResult()},t.prototype.executeLazy=function(){return this.runLazy?[this.runLazyQuery,this.execute()]:[this.runLazyQuery,{loading:!1,networkStatus:u.I.ready,called:!1,data:void 0}]},t.prototype.fetchData=function(){var e=this,t=this.getOptions();return!t.skip&&!1!==t.ssr&&new Promise((function(t){return e.startQuerySubscription(t)}))},t.prototype.afterExecute=function(e){var t=(void 0===e?{}:e).lazy,i=void 0!==t&&t;this.isMounted=!0;var r=this.getOptions();return this.currentObservable&&!this.ssrInitiated()&&this.startQuerySubscription(),i&&!this.runLazy||this.handleErrorOrCompleted(),this.previousOptions=r,this.unmount.bind(this)},t.prototype.cleanup=function(){this.removeQuerySubscription(),this.removeObservable(!0),delete this.previous.result},t.prototype.getOptions=function(){var t=e.prototype.getOptions.call(this);return this.lazyOptions&&(t.variables=(0,r.pi)((0,r.pi)({},t.variables),this.lazyOptions.variables),t.context=(0,r.pi)((0,r.pi)({},t.context),this.lazyOptions.context)),this.runLazy&&delete t.skip,t},t.prototype.ssrInitiated=function(){return this.context&&this.context.renderPromises},t.prototype.getExecuteSsrResult=function(){var e=this.getOptions(),t=e.ssr,i=e.skip,s=!1===t,n=this.refreshClient().client.disableNetworkFetches,o=(0,r.pi)({loading:!0,networkStatus:u.I.loading,called:!0,data:void 0,stale:!1,client:this.client},this.observableQueryFields());if(s&&(this.ssrInitiated()||n))return this.previous.result=o,o;if(this.ssrInitiated()){var a=this.getExecuteResult()||o;return a.loading&&!i&&this.context.renderPromises.addQueryPromise(this,(function(){return null})),a}},t.prototype.prepareObservableQueryOptions=function(){var e=this.getOptions();this.verifyDocumentType(e.query,a.n_.Query);var t=e.displayName||"Query";return!this.ssrInitiated()||"network-only"!==e.fetchPolicy&&"cache-and-network"!==e.fetchPolicy||(e.fetchPolicy="cache-first"),(0,r.pi)((0,r.pi)({},e),{displayName:t,context:e.context})},t.prototype.initializeObservableQuery=function(){if(this.ssrInitiated()&&(this.currentObservable=this.context.renderPromises.getSSRObservable(this.getOptions())),!this.currentObservable){var e=this.prepareObservableQueryOptions();this.previous.observableQueryOptions=(0,r.pi)((0,r.pi)({},e),{children:void 0}),this.currentObservable=this.refreshClient().client.watchQuery((0,r.pi)({},e)),this.ssrInitiated()&&this.context.renderPromises.registerSSRObservable(this.currentObservable,e)}},t.prototype.updateObservableQuery=function(){if(this.currentObservable){var e=(0,r.pi)((0,r.pi)({},this.prepareObservableQueryOptions()),{children:void 0});this.getOptions().skip?this.previous.observableQueryOptions=e:(0,n.D)(e,this.previous.observableQueryOptions)||(this.previous.observableQueryOptions=e,this.currentObservable.setOptions(e).catch((function(){})))}else this.initializeObservableQuery()},t.prototype.startQuerySubscription=function(e){var t=this;void 0===e&&(e=this.onNewData),this.currentSubscription||this.getOptions().skip||(this.currentSubscription=this.currentObservable.subscribe({next:function(i){var r=i.loading,s=i.networkStatus,o=i.data,u=t.previous.result;u&&u.loading===r&&u.networkStatus===s&&(0,n.D)(u.data,o)||e()},error:function(i){if(t.resubscribeToQuery(),!i.hasOwnProperty("graphQLErrors"))throw i;var r=t.previous.result;(r&&r.loading||!(0,n.D)(i,t.previous.error))&&(t.previous.error=i,e())}}))},t.prototype.resubscribeToQuery=function(){this.removeQuerySubscription();var e=this.currentObservable;if(e){var t=e.last;try{e.resetLastResults(),this.startQuerySubscription()}finally{e.last=t}}},t.prototype.getExecuteResult=function(){var e=this.observableQueryFields(),t=this.getOptions();if(t.skip)e=(0,r.pi)((0,r.pi)({},e),{data:void 0,error:void 0,loading:!1,networkStatus:u.I.ready,called:!0});else if(this.currentObservable){var i=this.currentObservable.getCurrentResult(),s=i.data,n=i.loading,a=i.partial,l=i.networkStatus,c=i.errors,v=i.error;if(c&&c.length>0&&(v=new o.c({graphQLErrors:c})),e=(0,r.pi)((0,r.pi)({},e),{data:s,loading:n,networkStatus:l,error:v,called:!0}),n);else if(v)Object.assign(e,{data:(this.currentObservable.getLastResult()||{}).data});else{var h=this.currentObservable.options.fetchPolicy;if(t.partialRefetch&&a&&(!s||0===Object.keys(s).length)&&"cache-only"!==h)return Object.assign(e,{loading:!0,networkStatus:u.I.loading}),e.refetch(),e}}e.client=this.client,this.setOptions(t,!0);var d=this.previous.result;return this.previous.loading=d&&d.loading||!1,e.previousData=d&&(d.data||d.previousData),this.previous.result=e,this.currentObservable&&this.currentObservable.resetQueryStoreErrors(),e},t.prototype.handleErrorOrCompleted=function(){if(this.currentObservable&&this.previous.result){var e=this.previous.result,t=e.data,i=e.loading,r=e.error;if(!i){var s=this.getOptions(),o=s.query,u=s.variables,a=s.onCompleted,l=s.onError,c=s.skip;if(this.previousOptions&&!this.previous.loading&&(0,n.D)(this.previousOptions.query,o)&&(0,n.D)(this.previousOptions.variables,u))return;!a||r||c?l&&r&&l(r):a(t)}}},t.prototype.removeQuerySubscription=function(){this.currentSubscription&&(this.currentSubscription.unsubscribe(),delete this.currentSubscription)},t.prototype.removeObservable=function(e){this.currentObservable&&(this.currentObservable.tearDownQuery(),e&&delete this.currentObservable)},t.prototype.observableQueryFields=function(){var e;return{variables:null===(e=this.currentObservable)||void 0===e?void 0:e.variables,refetch:this.obsRefetch,fetchMore:this.obsFetchMore,updateQuery:this.obsUpdateQuery,startPolling:this.obsStartPolling,stopPolling:this.obsStopPolling,subscribeToMore:this.obsSubscribeToMore}},t}(i(7164).V);var c=i(4273);function v(e,t,i){void 0===i&&(i=!1);var o=(0,s.useContext)((0,c.K)()),u=(0,s.useReducer)((function(e){return e+1}),0),a=u[0],v=u[1],h=t?(0,r.pi)((0,r.pi)({},t),{query:e}):{query:e},d=(0,s.useRef)(),p=d.current||(d.current=new l({options:h,context:o,onNewData:function(){p.ssrInitiated()?v():Promise.resolve().then((function(){return d.current&&d.current.isMounted&&v()}))}}));p.setOptions(h),p.context=o;var b=function(e,t){var i=(0,s.useRef)();return i.current&&(0,n.D)(t,i.current.key)||(i.current={key:t,value:e()}),i.current.value}((function(){return i?p.executeLazy():p.execute()}),{options:(0,r.pi)((0,r.pi)({},h),{onError:void 0,onCompleted:void 0}),context:o,tick:a}),_=i?b[1]:b;return __DEV__&&function(e){if(__DEV__){var t=(0,s.useRef)(!1);(0,s.useEffect)((function(){return function(){t.current=!0}}),[]),(0,s.useEffect)((function(){!0===t.current&&(t.current=!1,e())}),[])}}(v),(0,s.useEffect)((function(){return function(){p.cleanup(),d.current=void 0}}),[]),(0,s.useEffect)((function(){return p.afterExecute({lazy:i})}),[_.loading,_.networkStatus,_.error,_.data,p.currentObservable]),b}function h(e,t){return v(e,t,!1)}},8062:function(e,t,i){"use strict";i.r(t),i.d(t,{__N_SSP:function(){return _},default:function(){return f}});i(7294);var r=i(8152),s=i(570),n=i(5709),o=i(2626),u=i(7394),a=i(9723),l=i(8898),c=i.n(l),v=i(9023),h=i(6395),d=i(5893),p=function(e){var t=e.movie,i=(0,v.aC)().state.user,l=(0,s.a)(h.wq,{variables:{id:null===i||void 0===i?void 0:i.id}}).data,p=(0,s.a)(h.h8,{variables:{id:null===i||void 0===i?void 0:i.id}}).data,b=null===p||void 0===p?void 0:p.getUserWatchedMovies.some((function(e){return e.id===t.id})),_=null===l||void 0===l?void 0:l.getUserWantToWatchMovies.some((function(e){return e.id===t.id})),f=b?u.Rl:u.b1,y=_?u.EO:u.e1,m=(0,n.D)(f,{variables:{movieId:t.id},refetchQueries:[{query:h.h8,variables:{id:null===i||void 0===i?void 0:i.id}}]}),O=(0,r.Z)(m,1)[0],g=(0,n.D)(y,{variables:{movieId:t.id},refetchQueries:[{query:h.wq,variables:{id:null===i||void 0===i?void 0:i.id}}]}),x=(0,r.Z)(g,1)[0];return(0,d.jsxs)("div",{className:c().movie,children:[(0,d.jsxs)("div",{className:c().movie__left,children:[(0,d.jsx)("img",{src:a.a.IMAGE_LINK+t.poster_path,alt:t.title,title:t.title,className:c().movie__poster}),(0,d.jsxs)("div",{className:c().movie__buttons,children:[(0,d.jsx)(o.Z,{className:c().movie__want,onClick:O,children:b?"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0438\u0437 \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u043d\u043d\u044b\u0445":"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0432 \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u043d\u043d\u044b\u0435"}),(0,d.jsx)(o.Z,{className:c().movie__already,onClick:x,children:_?"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0438\u0437 \u0441\u043f\u0438\u0441\u043a\u0430 \u0436\u0435\u043b\u0430\u043d\u0438\u0439":"\u0425\u043e\u0447\u0443 \u043f\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c"})]})]}),(0,d.jsxs)("div",{className:c().movie__right,children:[(0,d.jsx)("h2",{className:c().movie__title,children:t.title}),(0,d.jsx)("h5",{className:c().movie__subtitle,children:t.original_title}),(0,d.jsxs)("ul",{className:c().info,children:[(0,d.jsxs)("li",{className:c().info__item,children:[(0,d.jsx)("span",{className:c().info__title,children:"\u0414\u0430\u0442\u0430 \u0432\u044b\u0445\u043e\u0434\u0430:"})," ",t.release_date]}),(0,d.jsxs)("li",{className:c().info__item,children:[(0,d.jsx)("span",{className:c().info__title,children:"\u0420\u0435\u0439\u0442\u0438\u043d\u0433:"})," ",t.vote_average]})]}),(0,d.jsx)("p",{className:c().movie__overview,children:t.overview})]})]})},b=i(9008),_=!0,f=function(e){var t=e.movie;return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(b.default,{children:(0,d.jsxs)("title",{children:["\u0424\u0438\u043b\u044c\u043c ",t.title]})}),(0,d.jsx)(p,{movie:t})]})}},6395:function(e,t,i){"use strict";i.d(t,{h8:function(){return c},wq:function(){return v}});var r,s,n,o,u=i(168),a=i(4397),l=i(3804),c=((0,a.Ps)(r||(r=(0,u.Z)(["\n\tquery getAllMovies {\n\t\tgetAllMovies {\n\t\t\t...Movie\n\t\t}\n\t}\n\t","\n"])),l.w),(0,a.Ps)(s||(s=(0,u.Z)(["\n\tquery getMovie($id: ID!) {\n\t\tgetMovie(id: $id) {\n\t\t\t...Movie\n\t\t}\n\t}\n\t","\n"])),l.w),(0,a.Ps)(n||(n=(0,u.Z)(["\n\tquery getUserWatchedMovies($id: ID!) {\n\t\tgetUserWatchedMovies(id: $id) {\n\t\t\t...Movie\n\t\t}\n\t}\n\t","\n"])),l.w)),v=(0,a.Ps)(o||(o=(0,u.Z)(["\n\tquery getUserWantToWatchMovies($id: ID!) {\n\t\tgetUserWantToWatchMovies(id: $id) {\n\t\t\t...Movie\n\t\t}\n\t}\n\t","\n"])),l.w)},9723:function(e,t,i){"use strict";i.d(t,{a:function(){return r}});var r={IMAGE_LINK:"https://image.tmdb.org/t/p/w300/"}},2521:function(e,t,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/movies/[id]",function(){return i(8062)}])},8898:function(e){e.exports={movie:"Movie_movie__1K50s",movie__left:"Movie_movie__left__29zBw",movie__right:"Movie_movie__right__2i2zY",movie__poster:"Movie_movie__poster__UGSKS",movie__already:"Movie_movie__already__19jIJ",movie__want:"Movie_movie__want__2kkfT",movie__addToList:"Movie_movie__addToList__3BVJO",movie__title:"Movie_movie__title__1aoHw",movie__subtitle:"Movie_movie__subtitle__2yc3P",movie__overview:"Movie_movie__overview__2PHcW",info:"Movie_info__3RMVS",info__item:"Movie_info__item__2LVtD",info__title:"Movie_info__title__2llPq"}}},function(e){e.O(0,[774,888,179],(function(){return t=2521,e(e.s=t);var t}));var t=e.O();_N_E=t}]);